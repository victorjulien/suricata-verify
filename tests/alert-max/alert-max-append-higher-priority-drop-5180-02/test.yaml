args:
- -k none
- --runmode=single
- --set stream.midstream=true
- --simulate-ips

checks:
# Subtest 1
- filter:
    lt-version: 8.0.4
    gt-version: 8.0.4
    count: 0
    match:
      event_type: alert
      alert.signature_id: 1
# Subtest 2
- filter:
    lt-version: 8.0.4
    gt-version: 8.0.4
    count: 1
    match:
      event_type: alert
      alert.signature_id: 2
      pcap_cnt: 1
      pkt_src: "wire/pcap"
      verdict.action: drop
# Subtest 3
- filter:
    lt-version: 8.0.4
    gt-version: 8.0.4
    count: 1
    match:
      event_type: alert
      alert.signature_id: 3
      pcap_cnt: 1
      pkt_src: "wire/pcap"
      verdict.action: drop
# Subtest 4
# Matches, but not enough space in packet alert queue
- filter:
    lt-version: 8.0.4
    gt-version: 8.0.4
    count: 0
    match:
      event_type: alert
      alert.signature_id: 4
# Subtest 5
- filter:
    lt-version: 8.0.4
    gt-version: 8.0.4
    count: 1
    match:
      event_type: alert
      alert.signature_id: 5
      pcap_cnt: 1
      pkt_src: "wire/pcap"
      verdict.action: drop
# Subtest 6
# Matches, but not enough space in packet alert queue
- filter:
    lt-version: 8.0.4
    gt-version: 8.0.4
    count: 0
    match:
      event_type: alert
      alert.signature_id: 6
# Subtest 7
- filter:
    lt-version: 8.0.4
    gt-version: 8.0.4
    count: 1
    match:
      event_type: drop
      pcap_cnt: 1
      drop.reason: rules
# Subtest 8
- filter:
    lt-version: 8.0.4
    gt-version: 8.0.4
    count: 1
    match:
      event_type: drop
      pcap_cnt: 2
      drop.reason: "flow drop"
# Subtest 9
- filter:
    lt-version: 8.0.4
    gt-version: 8.0.4
    count: 1
    match:
      event_type: flow
      flow.action: "drop"
# Subtest 10
- filter:
    lt-version: 8.0.4
    gt-version: 8.0.4
    count: 1
    match:
      event_type: stats
      stats.decoder.pkts: 7
      stats.detect.alert_queue_overflow: 1
      stats.detect.alert: 3
      stats.ips.accepted: 0
      stats.ips.blocked: 7
      stats.ips.drop_reason.flow_drop: 6
      stats.ips.drop_reason.rules: 1
